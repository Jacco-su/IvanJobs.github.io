---
layout: post
title: Consistent Hashing (一致性哈希)笔记
category: 算法
---

关于一致性哈希，[这篇博文](http://blog.codinglabs.org/articles/consistent-hashing.html)可谓写的浅显易懂。

### 解决的问题
hash是简单来说就是做映射的，k1映射到v1, k2映射到v2。。。，只要是同样的key，必定会映射到同样的value。v1, v2, ...这些值是有个值域的，在hash的上下文里即hash space或者说映射空间。如果映射空间的大小不变还好说，如果hash space是可以动态变化的，那么原先的k->v映射和hash space变化后的k->v映射，会有很大一部分是变动的。一致性hash解决的就是hash space变化带来的大变动问题，将这个大变动尽量减到最小。

### 一致性哈希原理
首先一致性哈希的hash space是一个环，比如0 ~ 2^32 - 1, hash映射都是针对这个环来映射，也就是key和value都映射到环上，以这个环形的hash space作为中介，在环上再进行一次映射，映射方法可以选择“基于key映射值，顺时针找到第一个value映射值”， 这样就把key和value映射了起来。这样，如果value的值域发生变化，即增加或者减少一个value, 只会影响变动部分的映射，其他的映射不会受到影响。在软件领域，很多问题都是通过增加一个层来解决，这里一致性hash也是在传统hash的基础上，增加了一个环层来解决的，所以很多东西是殊途同归的。

### 如何顺时针找到第一个value？
这个问题模型，本质上是查找问题。故可以用二分查找的方法，在对数的复杂度内解决，如果知道常数时间的方法，请告知我。
